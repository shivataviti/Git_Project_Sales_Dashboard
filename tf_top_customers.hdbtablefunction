FUNCTION "salesproject.db::tf_top_customers" ()
RETURNS TABLE (
  CUSTOMER_ID NVARCHAR(10),
  TOTAL_AMOUNT DECIMAL(10,2)
)
LANGUAGE SQLSCRIPT
SQL SECURITY INVOKER
AS
BEGIN
  RETURN 
  SELECT CUSTOMER_ID, SUM(AMOUNT) AS TOTAL_AMOUNT
  FROM "sales_order_items"
  GROUP BY CUSTOMER_ID
  ORDER BY TOTAL_AMOUNT DESC
  LIMIT 10;
END;